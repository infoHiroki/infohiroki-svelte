<script lang="ts">
  import { page } from '$app/stores';
  import { onMount } from 'svelte';
  import { toggleTheme, getCurrentTheme, type Theme } from '$lib/utils/theme';

  $: currentPath = $page.url.pathname;
  $: isActive = (path: string) => currentPath === path;

  let currentTheme: Theme = 'light';

  onMount(() => {
    currentTheme = getCurrentTheme();
  });

  function handleToggleTheme() {
    currentTheme = toggleTheme();
  }
</script>

<!-- ãƒ¢ãƒã‚¤ãƒ«ç”¨ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<header class="mobile-header">
  <div class="mobile-header-content">
    <a href="/" class="mobile-logo">
      <img src="/images/logo.svg" alt="infoHiroki Logo" width="36" height="36">
      <span class="mobile-title">infoHiroki</span>
    </a>
    <button class="theme-toggle" on:click={handleToggleTheme} aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿">
      <span class="theme-icon">{currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™'}</span>
    </button>
    <button class="hamburger-button" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </div>
</header>

<!-- ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç”¨ã‚µã‚¤ãƒ‰ãƒãƒ¼ / ãƒ¢ãƒã‚¤ãƒ«ç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
<aside class="sidebar">
  <div class="sidebar-header">
    <a href="/" class="site-title">
      <div class="logo">
        <img src="/images/logo.svg" alt="infoHiroki Logo" width="36" height="36">
      </div>
      <div class="title-text">
        <span class="company-name">infoHiroki</span>
      </div>
    </a>
  </div>

  <nav class="sidebar-nav">
    <ul class="nav-menu">
      <li class="nav-item{isActive('/') ? ' active' : ''}">
        <a href="/" class="nav-link">ãƒ›ãƒ¼ãƒ </a>
      </li>
      <li class="nav-item{isActive('/blog') ? ' active' : ''}">
        <a href="/blog" class="nav-link">ãƒ–ãƒ­ã‚°</a>
      </li>
      <li class="nav-item{isActive('/services') ? ' active' : ''}">
        <a href="/services" class="nav-link">ã‚µãƒ¼ãƒ“ã‚¹</a>
      </li>
      <li class="nav-item{isActive('/products') ? ' active' : ''}">
        <a href="/products" class="nav-link">é–‹ç™ºè£½å“</a>
      </li>
      <li class="nav-item{isActive('/results') ? ' active' : ''}">
        <a href="/results" class="nav-link">å®Ÿç¸¾</a>
      </li>
      <li class="nav-item{isActive('/about') ? ' active' : ''}">
        <a href="/about" class="nav-link">ã‚¹ã‚­ãƒ«ã‚¹ã‚¿ãƒƒã‚¯</a>
      </li>
      <li class="nav-item{isActive('/faq') ? ' active' : ''}">
        <a href="/faq" class="nav-link">FAQ</a>
      </li>
      <li class="nav-item{isActive('/contact') ? ' active' : ''}">
        <a href="/contact" class="nav-link">ãŠå•ã„åˆã‚ã›</a>
      </li>
    </ul>
    <button class="theme-toggle-sidebar" on:click={handleToggleTheme} aria-label="ãƒ†ãƒ¼ãƒåˆ‡æ›¿">
      <span class="theme-icon">{currentTheme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™'}</span>
      <span class="theme-label">{currentTheme === 'dark' ? 'ãƒ©ã‚¤ãƒˆ' : 'ãƒ€ãƒ¼ã‚¯'}</span>
    </button>
  </nav>
</aside>

<!-- ãƒ¢ãƒã‚¤ãƒ«ç”¨ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
<div class="mobile-overlay"></div>
